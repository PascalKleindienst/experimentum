

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Migrations &mdash; experimentum  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Repositories" href="repositories.html" />
    <link rel="prev" title="CLI Commands" href="commands.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> experimentum
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="service.html">Service Container and Provider</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">CLI Commands</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Migrations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#generating-migrations">Generating Migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#migration-structure">Migration Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-migrations">Running Migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tables">Tables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-tables">Creating Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checking-existence">Checking Existence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#renaming-dropping-tables">Renaming / Dropping Tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#columns">Columns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-columns">Adding Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#column-modifiers">Column Modifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dropping-columns">Dropping Columns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#indexes">Indexes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#available-index-types">Available Index Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dropping-indexes">Dropping Indexes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#foreign-key-contraints">Foreign Key Contraints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="repositories.html">Repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="experiments.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/modules.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">experimentum</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Migrations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/migrations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-experimentum.Commands.MigrationCommand">
<span id="migrations"></span><h1>Migrations<a class="headerlink" href="#module-experimentum.Commands.MigrationCommand" title="Permalink to this headline">¶</a></h1>
<p>Migration CLI commands to allow you to version control your database schema.</p>
<p>With Migrations your team is able to easily modify and share the
database schema to stay up to date. Migrations are typically paired
with the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#module-experimentum.Storage.Migrations.Schema" title="experimentum.Storage.Migrations.Schema"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Schema</span></code></a> Builder which is inspired by the
<a class="reference external" href="https://laravel.com/docs/5.6/migrations#tables">Laravel Schema Builder</a>
to easly manage your database’s schema.</p>
<div class="section" id="generating-migrations">
<h2>Generating Migrations<a class="headerlink" href="#generating-migrations" title="Permalink to this headline">¶</a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">migration:make</span></code> command  to create a new <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration" title="experimentum.Storage.Migrations.Migration.Migration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Migration</span></code></a>. This will create the
following new <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration" title="experimentum.Storage.Migrations.Migration.Migration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Migration</span></code></a> class in your <code class="docutils literal notranslate"><span class="pre">migrations</span></code> folder. In order to determine
the order of the migrations, each migration file name contains a timestamp.</p>
<p>Arguments:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>name</td>
<td>Name of the migration</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="migration-structure">
<h2>Migration Structure<a class="headerlink" href="#migration-structure" title="Permalink to this headline">¶</a></h2>
<p>Each <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration" title="experimentum.Storage.Migrations.Migration.Migration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Migration</span></code></a> class contains two methods: <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration.up" title="experimentum.Storage.Migrations.Migration.Migration.up"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Migration.up()</span></code></a> and
<a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration.down" title="experimentum.Storage.Migrations.Migration.Migration.down"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Migration.down()</span></code></a>. In the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration.up" title="experimentum.Storage.Migrations.Migration.Migration.up"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Migration.up()</span></code></a> method you add new tables,
columns, or indexes to your database. In the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration.down" title="experimentum.Storage.Migrations.Migration.Migration.down"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Migration.down()</span></code></a> method you
should revert those changed made in the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration.up" title="experimentum.Storage.Migrations.Migration.Migration.up"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Migration.up()</span></code></a> method.</p>
<p>Inside the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration" title="experimentum.Storage.Migrations.Migration.Migration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Migration</span></code></a> class you have access to the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#module-experimentum.Storage.Migrations.Schema" title="experimentum.Storage.Migrations.Schema"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Schema</span></code></a> Builder
to easily create and modify tables. For more information check out its documentation:
<a class="reference internal" href="source/experimentum.Storage.Migrations.html#module-experimentum.Storage.Migrations.Schema" title="experimentum.Storage.Migrations.Schema"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Schema</span></code></a></p>
</div>
<div class="section" id="running-migrations">
<h2>Running Migrations<a class="headerlink" href="#running-migrations" title="Permalink to this headline">¶</a></h2>
<p>To run the latest outstanding <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration" title="experimentum.Storage.Migrations.Migration.Migration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Migration</span></code></a>, just use the <code class="docutils literal notranslate"><span class="pre">migration:up</span></code> command.
To revert the last <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Migration.Migration" title="experimentum.Storage.Migrations.Migration.Migration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Migration</span></code></a> operation, just use the <code class="docutils literal notranslate"><span class="pre">migration:down</span></code> command.</p>
<p>To roll back all migrations and then execute all migrations, just use the <code class="docutils literal notranslate"><span class="pre">migration:refresh</span></code>
command. This command effectively re-creates your entire database.</p>
<p>To see the status of the migrations, just use the <code class="docutils literal notranslate"><span class="pre">migration:status</span></code> command.
This would output something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>|-------------------------------------------+--------|
| Migration                                 | Ran?   |
|-------------------------------------------+--------|
| 20180814111005_create_users_table         | Yes    |
| 20180815101334_add_avater_to_users_table  | No     |
|-------------------------------------------+--------|
</pre></div>
</div>
</div>
<span class="target" id="module-experimentum.Storage.Migrations.Schema"></span><p>The <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema" title="experimentum.Storage.Migrations.Schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> class provides a database agnostic way of manipulating tables.</p>
<div class="section" id="tables">
<h2>Tables<a class="headerlink" href="#tables" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-tables">
<h3>Creating Tables<a class="headerlink" href="#creating-tables" title="Permalink to this headline">¶</a></h3>
<p>To create a new database table, the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema.create" title="experimentum.Storage.Migrations.Schema.Schema.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> method is used.
The <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema.create" title="experimentum.Storage.Migrations.Schema.Schema.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> method accepts a table name as its argument and returns
a <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Blueprint.Blueprint" title="experimentum.Storage.Migrations.Blueprint.Blueprint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Blueprint</span></code></a> instance that can be used to define the new table.
When creating the table, you may use any of the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Blueprint.Blueprint" title="experimentum.Storage.Migrations.Blueprint.Blueprint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Blueprint</span></code></a> column methods
to define the table’s columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">table</span><span class="o">.</span><span class="n">increments</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="checking-existence">
<h3>Checking Existence<a class="headerlink" href="#checking-existence" title="Permalink to this headline">¶</a></h3>
<p>To check if a table or column exist you can use the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema.has_table" title="experimentum.Storage.Migrations.Schema.Schema.has_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">has_table()</span></code></a> or
<a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema.has_column" title="experimentum.Storage.Migrations.Schema.Schema.has_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">has_column()</span></code></a> methods respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">):</span>
    <span class="c1"># ...</span>

<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">has_column</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">):</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
</div>
<div class="section" id="renaming-dropping-tables">
<h3>Renaming / Dropping Tables<a class="headerlink" href="#renaming-dropping-tables" title="Permalink to this headline">¶</a></h3>
<p>To rename an existing database table, use the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema.rename" title="experimentum.Storage.Migrations.Schema.Schema.rename"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rename()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To drop a table, you can use the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema.drop" title="experimentum.Storage.Migrations.Schema.Schema.drop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop()</span></code></a> or
<a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema.drop_if_exists" title="experimentum.Storage.Migrations.Schema.Schema.drop_if_exists"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop_if_exists()</span></code></a> methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">drop_if_exists</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<span class="target" id="module-experimentum.Storage.Migrations.Blueprint"></span><p>The <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Blueprint.Blueprint" title="experimentum.Storage.Migrations.Blueprint.Blueprint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Blueprint</span></code></a> class lets you create, delete, or alter columns of a table.</p>
<div class="section" id="columns">
<h2>Columns<a class="headerlink" href="#columns" title="Permalink to this headline">¶</a></h2>
<div class="section" id="adding-columns">
<h3>Adding Columns<a class="headerlink" href="#adding-columns" title="Permalink to this headline">¶</a></h3>
<p>To update an existing table, you can use the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Schema.Schema.table" title="experimentum.Storage.Migrations.Schema.Schema.table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Schema.table()</span></code></a> method.
The method accepts a table name as its argument and returns a <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Blueprint.Blueprint" title="experimentum.Storage.Migrations.Blueprint.Blueprint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Blueprint</span></code></a>
instance that can be used to add columns to the table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">table</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="s1">&#39;address&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nullable</span><span class="p">()</span>
    <span class="n">table</span><span class="o">.</span><span class="n">integer</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nullable</span><span class="p">()</span><span class="o">.</span><span class="n">unsigned</span><span class="p">()</span>
</pre></div>
</div>
<p>The table builder contains a plethora of column types that you can use when building your tables:</p>
<table border="1" class="docutils">
<colgroup>
<col width="44%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.array('ratings',</span> <span class="pre">'integer',</span> <span class="pre">2)</span></code></td>
<td>ARRAY column type. Only supported in <strong>postgresql</strong>!</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.big_increments('id')</span></code></td>
<td>Auto-incrementing ID using a “big integer” (primary
key) equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.big_integer('votes)</span></code></td>
<td>BIGINT equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.binary('data')</span></code></td>
<td>BLOB equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.boolean('confirmed')</span></code></td>
<td>BOOLEAN equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.char('name',</span> <span class="pre">4)</span></code></td>
<td>CHAR equivalent column with a length.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.date('created_on')</span></code></td>
<td>DATE equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.datetime('created_at')</span></code></td>
<td>DATETIME equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.decimal('amount',</span> <span class="pre">5,</span> <span class="pre">2)</span></code></td>
<td>DECIMAL equivalent column with a precision
<em>(total digits)</em> and a scale <em>(decimal digits)</em>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.double('column',</span> <span class="pre">15,</span> <span class="pre">8)</span></code></td>
<td>DOUBLE equivalent column with a precision
<em>(total digits)</em> and a scale <em>(decimal digits)</em>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.enum('choices',</span> <span class="pre">['foo',</span> <span class="pre">'bar'])</span></code></td>
<td>ENUM equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.float('amount')</span></code></td>
<td>FLOAT equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.increments('id')</span></code></td>
<td>Auto-incrementing ID using a “integer” (primary key)
equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.integer('votes')</span></code></td>
<td>INTEGER equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.json('options')</span></code></td>
<td>JSON equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.long_text('description')</span></code></td>
<td>LONGTEXT equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.medium_integer('votes')</span></code></td>
<td>MEDIUMINT equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.medium_text('description')</span></code></td>
<td>MEDIUMTEXT equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.small_integer('votes')</span></code></td>
<td>SMALLINT equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.string('email')</span></code></td>
<td>VARCHAR equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.string('votes',</span> <span class="pre">100)</span></code></td>
<td>VARCHAR equivalent column with a length.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.text('description')</span></code></td>
<td>TEXT equivalent column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.time('sunrise')</span></code></td>
<td>TIME equivalent column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.timestamp('added_at')</span></code></td>
<td>TIMESTAMP equivalent column.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="column-modifiers">
<h3>Column Modifiers<a class="headerlink" href="#column-modifiers" title="Permalink to this headline">¶</a></h3>
<p>Each of the column methods above returns a <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Column.Column" title="experimentum.Storage.Migrations.Column.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> instance, which lets you add several
column “modifier” while adding a column to a table. For example, to make a column “nullable” you can
use the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Column.Column.nullable" title="experimentum.Storage.Migrations.Column.Column.nullable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nullable()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">table</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nullable</span><span class="p">()</span>
</pre></div>
</div>
<p>The column modifiers are the following <em>(does not include index modifiers)</em>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Modifier</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">.default('default_value')</span></code></td>
<td>Specify a default value for the column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">.nullable()</span></code></td>
<td>Designate that the column allows NULL values.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">.unsigned()</span></code></td>
<td>Set INTEGER column as UNSINGED <em>(MySQL)</em>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="dropping-columns">
<h3>Dropping Columns<a class="headerlink" href="#dropping-columns" title="Permalink to this headline">¶</a></h3>
<p>To drop a column from a table, you can use the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Blueprint.Blueprint.drop_column" title="experimentum.Storage.Migrations.Blueprint.Blueprint.drop_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop_column()</span></code></a>
method.</p>
<p>Dropping a column from a database table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">table</span><span class="o">.</span><span class="n">drop_column</span><span class="p">(</span><span class="s1">&#39;votes&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Dropping multiple columns from a database table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">table</span><span class="o">.</span><span class="n">drop_column</span><span class="p">(</span><span class="s1">&#39;votes&#39;</span><span class="p">,</span> <span class="s1">&#39;avatar&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="indexes">
<h2>Indexes<a class="headerlink" href="#indexes" title="Permalink to this headline">¶</a></h2>
<p>The schema builder supports several types of indexes which you can add to and/or drop from columns.
You can create the index after defining the column. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="available-index-types">
<h3>Available Index Types<a class="headerlink" href="#available-index-types" title="Permalink to this headline">¶</a></h3>
<p>Each index method accepts an optional second argument to specify the name of the index.
If omitted, the name will be derived from the names of the table and column(s).
Below is a list of all available index types:</p>
<table border="1" class="docutils">
<colgroup>
<col width="64%" />
<col width="36%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.primary('id')</span></code></td>
<td>Addys a primary key.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.primary(['id',</span> <span class="pre">'parent_id'])</span></code></td>
<td>Adds composite keys.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.unique('email)</span></code></td>
<td>Adds a unique index.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.index('state')</span></code></td>
<td>Adds a basic index.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">MySQL</span></code>/<code class="docutils literal notranslate"><span class="pre">MariaDB</span></code> and <code class="docutils literal notranslate"><span class="pre">PostgreSQL</span></code> the length of indexes are limited.
experimentum generates index names based on table and column names, therefore if
your column names are too long you can pass the <code class="docutils literal notranslate"><span class="pre">name</span></code> keyword argument to specify
your own index name:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;some_field_with_a_really_long_name&#39;</span><span class="p">,</span> <span class="s1">&#39;another_really_long_field&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;my_idx_name&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dropping-indexes">
<h3>Dropping Indexes<a class="headerlink" href="#dropping-indexes" title="Permalink to this headline">¶</a></h3>
<p>To drop an index you must specify the index’s columns. experimentum assigns a reasonable
name to the indexes by default. If you have specified a custom index name, you have to add
it as the optional second argument.</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.drop_primary('id')</span></code></td>
<td>Drop a primary key from the “id” column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.drop_unique('email)</span></code></td>
<td>Drop a unique index from the “email” column.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">table.drop_index('state')</span></code></td>
<td>Drop a basic index from the “state” column.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">table.drop_foreign('user_id')</span></code></td>
<td>Drop a foreign key from the “user_id” column.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="foreign-key-contraints">
<h2>Foreign Key Contraints<a class="headerlink" href="#foreign-key-contraints" title="Permalink to this headline">¶</a></h2>
<p>experimentum also provides support for adding foreign key constraints to your tables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">table</span><span class="o">.</span><span class="n">increments</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">foreign</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">references</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">on_delete</span><span class="p">(</span><span class="s1">&#39;cascade&#39;</span><span class="p">)</span>\
        <span class="o">.</span><span class="n">on_update</span><span class="p">(</span><span class="s1">&#39;cascade&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, we are stating that the <code class="docutils literal notranslate"><span class="pre">user_id</span></code> column references the <code class="docutils literal notranslate"><span class="pre">id</span></code> column
on the <code class="docutils literal notranslate"><span class="pre">users</span></code> table and set the “on update” and “on delete” actions to <code class="docutils literal notranslate"><span class="pre">cascade</span></code>.
Make sure to create the foreign key column first!</p>
<p>To drop a foreign key, you can use the <a class="reference internal" href="source/experimentum.Storage.Migrations.html#experimentum.Storage.Migrations.Blueprint.Blueprint.drop_foreign" title="experimentum.Storage.Migrations.Blueprint.Blueprint.drop_foreign"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop_foreign()</span></code></a> method. It works
just like dropping an index.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="repositories.html" class="btn btn-neutral float-right" title="Repositories" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="commands.html" class="btn btn-neutral float-left" title="CLI Commands" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Pascal Kleindienst

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>